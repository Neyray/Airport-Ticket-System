# 📂 项目文件结构说明

本项目采用前后端分离架构，使用 C++ 实现后端 RESTful API 服务器，HTML/CSS/JavaScript 实现前端界面。目录结构清晰，便于扩展、维护与阅读。

---

## 📁 根目录

* **README.md**  
  项目的总体介绍、功能说明、运行方式和使用说明。

* **FILES.md**  
  当前文件，详细说明项目的整体目录结构及各部分作用。

---

## 📁 .vscode/ — VS Code 配置目录

存放 VS Code 的项目级配置文件。

* **tasks.json**  
  * 配置 g++ 编译指令
  * 链接 Windows 网络库：`-lws2_32`
  * 添加 Windows 网络宏：`-D_WIN32_WINNT=0x0A00`
  * 自动构建生成 `build/AirTicketSystem.exe`
  * 设置相对路径，确保编译后程序在 `build/` 目录正确运行

---

## 📁 public/ — 🌐 前端资源（Web 界面）

存放前端页面与静态资源，由 C++ 后端服务器托管，用户通过浏览器访问。

* **index.html** — 前端主页面  
  * 提供完整的用户界面：登录/注册面板、航班查询表格、订票/退票功能
  * 包含内联 CSS 样式和 JavaScript 交互逻辑
  * 实现了响应式设计，支持移动端访问
  * 集成用户认证、航班搜索、订单管理等完整功能

* **style.css** *(已废弃)*  
  原独立样式文件，现已整合到 `index.html` 中的 `<style>` 标签内。

* **script.js** *(已废弃)*  
  原独立脚本文件，现已整合到 `index.html` 中的 `<script>` 标签内。

> **注意**：当前版本采用单文件模式，所有前端代码集中在 `index.html` 中，便于部署和管理。

---

## 📁 data/ — 🗄️ 数据存储（文本数据库）

使用文本文件作为持久化存储，便于调试和数据管理。

* **flights.txt** — 航班数据  
  格式：`航班号|出发地|目的地|价格|剩余座位数`  
  示例：`CA1001|北京|上海|800|50`

* **tickets.txt** — 订票记录  
  格式：`订票号|航班号|用户名|价格|是否已退票(0/1)`  
  示例：`T1734567890|CA1001|testuser|800|0`

* **users.txt** — 用户信息  
  格式：`用户名|密码|真实姓名|身份证号`  
  示例：`testuser|123456|张三|110101199001011234`

> **数据格式说明**：
> - 使用 `|` 作为字段分隔符
> - 以 `#` 开头的行为注释，会被忽略
> - C++ 后端在启动时自动加载这些文件

---

## 📁 include/ — 🔧 C++ 头文件（接口声明）

存放各模块的 `.h` 文件，定义类接口和 API。

* **httplib.h**  
  * cpp-httplib 库头文件（v0.28.0）
  * 提供完整的 HTTP 服务器和客户端功能
  * 支持 GET、POST、PUT、DELETE 等 RESTful 操作
  * 包含 SSL/TLS 支持、文件上传、流式传输等高级特性

* **Server.h**  
  * 定义 `AirTicketServer` 类
  * 声明服务器初始化、路由配置、运行方法
  * 包含 Database 对象用于数据管理

* **Database.h**  
  * 定义 `Database` 类接口
  * 声明数据加载、保存、查询、更新等操作
  * 管理航班、订票、用户三大数据集合

* **Flight.h**  
  * 定义 `Flight` 类（航班实体）
  * 包含航班号、出发地、目的地、价格、座位数等属性
  * 提供订座、退座、序列化等方法

* **Ticket.h**  
  * 定义 `Ticket` 类（订票记录）
  * 包含订票号、航班号、用户名、价格、退票状态等属性
  * 提供取消订票、序列化等方法

* **User.h**  
  * 定义 `User` 类（用户信息）
  * 包含用户名、密码、真实姓名、身份证号等属性
  * 提供密码验证、序列化等方法

---

## 📁 src/ — ⚙️ C++ 源文件（逻辑实现）

存放 `.cpp` 文件，实现头文件中声明的功能。

* **main.cpp** — 程序入口  
  * 设置 Windows 控制台 UTF-8 编码（`SetConsoleOutputCP(65001)`）
  * 创建并启动 `AirTicketServer` 实例
  * 输出启动信息和访问地址

* **Server.cpp** — 服务器核心逻辑  
  * 实现 Web 服务器初始化
  * 配置静态文件托管（`/public` 目录）
  * 注册 RESTful API 路由：
    - `POST /api/register` - 用户注册
    - `POST /api/login` - 用户登录
    - `GET /api/flights` - 查询航班（支持筛选）
    - `POST /api/book` - 订票
    - `GET /api/tickets` - 查询订单
    - `POST /api/cancel` - 退票
  * 处理 HTTP 请求并返回 JSON 响应

* **Database.cpp** — 数据库管理实现  
  * 实现文件读写操作
  * 将文本数据转换为 C++ 对象
  * 提供航班、订票、用户的 CRUD 操作
  * 处理数据持久化

* **Flight.cpp** — 航班类实现  
  * 实现航班的订座、退座逻辑
  * 序列化/反序列化方法（`toString()` / `fromString()`）

* **Ticket.cpp** — 订票类实现  
  * 实现订票的取消功能
  * 序列化/反序列化方法

* **User.cpp** — 用户类实现  
  * 实现密码验证逻辑
  * 序列化/反序列化方法

---

## 📁 build/ — 🏗️ 编译输出目录

存放编译生成的可执行文件。

* **AirTicketSystem.exe**  
  编译后的可执行程序，运行后启动 Web 服务器监听 8080 端口。

> **重要提示**：
> - 程序必须在 `build/` 目录下运行，因为相对路径设置为 `../data/` 和 `../public/`
> - 如果在其他位置运行会导致找不到数据文件和前端资源

---

## 🔄 数据流示意图
```
前端 (浏览器)
    ↓ HTTP 请求 (JSON)
后端 (C++ Server)
    ↓ 数据操作
数据库 (文本文件)
    ↑ 读取/写入
后端 (C++ Server)
    ↑ HTTP 响应 (JSON)
前端 (浏览器)
```

---

## 📝 文件路径说明

项目采用相对路径设计，确保程序在 `build/` 目录正常运行：

| 代码引用               | 实际路径            | 说明       |
| ------------------ | --------------- | -------- |
| `../data/*.txt`    | `data/*.txt`    | 数据文件     |
| `../public/*`      | `public/*`      | 前端静态资源   |
| `../include/*.h`   | `include/*.h`   | C++ 头文件  |
| `../src/*.cpp`     | `src/*.cpp`     | C++ 源文件  |
| `build/*.exe`      | `build/*.exe`   | 编译生成的可执行文件 |

---

## 🎯 项目特点

1. **前后端分离**：清晰的架构边界，便于独立开发和维护
2. **RESTful API**：标准的 HTTP 接口设计
3. **轻量级部署**：无需数据库软件，使用文本文件存储
4. **跨平台潜力**：核心代码可移植到 Linux/macOS（需调整部分 Windows 特定代码）
5. **易于扩展**：模块化设计，便于添加新功能

---